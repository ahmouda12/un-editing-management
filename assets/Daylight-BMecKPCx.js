const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/calcite-button-CqG1PB6a.js","assets/button-BnsH0Xdf.js","assets/index-B252NKV0.js","assets/index-HngaTkmj.css","assets/form-ChvLHK8c.js","assets/dom-CtEXAB-7.js","assets/interactive-CNwnbIDi.js","assets/label-zjh2qsd9.js","assets/component-6CIDVndn.js","assets/loadable-CSj6RaJ-.js","assets/locale-BET6kD7U.js","assets/key-D63ExP77.js","assets/observers-C2A34Kee.js","assets/t9n-lBCEDqGe.js","assets/icon-DaxhXezS.js","assets/loader-p1bx6ime.js","assets/calcite-checkbox-BsA-vHIv.js","assets/calcite-label-D93hjYEn.js","assets/calcite-option-DRecTMIe.js","assets/calcite-select-DIYH3iOC.js","assets/Validation-CPEZsdMf.js","assets/input-message-an8pCEmq.js"])))=>i.map(i=>d[i]);
import{iE as ne,qJ as oe,qK as le,x as s,y as o,B as k,ab as Q,eO as X,fs as F,cR as m,g1 as ae,eT as D,qL as re,qM as L,qN as de,nw as W,cT as q,gJ as he,bH as pe,aU as Z,lM as ge,iq as c,im as Y,io as ce,eS as me,q2 as ue,nb as ye,lK as f,ip as _e,_ as T}from"./index-B252NKV0.js";import{n as we,d as G,f as fe}from"./EdgeShader.glsl-B6xvxs0N.js";import{c as ve}from"./earthUtils-DV53znm3.js";import{l as be,A as Se}from"./Slider-6hVF64iT.js";import{t as ee,f as J,l as Te,d as De,$ as Pe}from"./DatePicker-CQA0FV_M.js";import"./WaterSurface.glsl-DJiRVkTI.js";import"./Scheduler-D2EdV-K_.js";import"./debugFlags-BYwEz_hP.js";import"./RenderState-DaVlEYWY.js";import"./ElevationContext-0u_g65xQ.js";import"./Material-5cwIpifF.js";import"./interfaces-CGza0uBR.js";import"./basicInterfaces-DngWxyLO.js";import"./ContentObject-BZXFh7BC.js";import"./VertexAttribute-BnAa5VW0.js";import"./Util-DsJryf9x.js";import"./IntegerPassUniform-BV9MAEur.js";import"./enums-DSseSvdG.js";import"./Texture-BT-WYJiR.js";import"./BindType-BmZEZMMh.js";import"./mat3-DPPMYMhB.js";import"./ShaderTechniqueConfiguration-Ba2Oo7i0.js";import"./doublePrecisionUtils-B0owpBza.js";import"./requestImageUtils-DzTga_rS.js";import"./axisAngleDegrees-C5xDLED1.js";import"./quat-3FyS98Fp.js";import"./weather-BLxro0E8.js";import"./NestedMap-DgiGbX8E.js";import"./frustum-VM_sBTPR.js";import"./Attribute-B-NAci_J.js";import"./Geometry-Ba4xjwln.js";import"./Indices-BSZ2vHzt.js";import"./triangle-BvzaHny8.js";import"./lineSegment-BMYSACYW.js";import"./Octree-C_vy2cBS.js";import"./InterleavedLayout-DjPFAyuB.js";import"./BufferView-DithrMUX.js";import"./types-D0PSWh4d.js";import"./OrderIndependentTransparency-Dar7ikM6.js";import"./floatRGBA-0vmpOgzj.js";import"./Intersector-DFmhN7LU.js";import"./ElevationProvider-Z72XcWTz.js";import"./boundedPlane-YCrsjrS8.js";import"./verticalOffsetUtils-Byw9d5zq.js";import"./orientedBoundingBox-B61nPEal.js";import"./spatialReferenceEllipsoidUtils-DV15qcib.js";import"./computeTranslationToOriginAndRotation-BwxvMbbc.js";import"./glUtil-DS73TAjp.js";import"./VertexElementDescriptor-BOD-G50G.js";import"./VertexArrayObject-adc8SYn-.js";import"./BufferObject-DdM-Y0w0.js";import"./vec3f32-Cw9Q6TO_.js";import"./DoubleArray-DydFqj4b.js";import"./hydratedFeatures-BRhOD9YG.js";import"./ColorMaterial.glsl-9YKbkIUs.js";import"./VertexColor.glsl-D4WHfTL4.js";import"./vec2f32-BbH2jxlN.js";import"./dehydratedFeatures-Dt-SjqTC.js";import"./featureConversionUtils-BVsMNPzF.js";import"./OptimizedFeature-CXeSoBCN.js";import"./OptimizedFeatureSet-Blu9Ckm7.js";import"./OptimizedGeometry-DLPswkPy.js";import"./edgeUtils-M6KOVtH3.js";import"./earcut-gCDAS0gj.js";import"./vec3-DPfuEKPJ.js";import"./SnappingCandidate-O5eRSE6e.js";import"./triangulationUtils-B5WoxWgr.js";import"./deduplicate-aiEVsYi-.js";import"./Normals-C_NhLO8Y.js";import"./RealisticTree.glsl-CwQ9Or_P.js";import"./DefaultMaterial_COLOR_GAMMA-DpjIaYJf.js";import"./resourceUtils-BT8kUm1Z.js";import"./symbolColorUtils-D89hqBDM.js";import"./CIMSymbolHelper-ZEeHC0zq.js";import"./BidiEngine-BwB1Df7c.js";import"./fontUtils-oEBemou-.js";import"./GeometryUtils-BvoQHMVi.js";import"./enums-BRqP_wXA.js";import"./definitions-B54owTRu.js";import"./Rect-CUzevAry.js";import"./BoundingBox-BhuXqU4L.js";import"./line-MrNX-P16.js";import"./projectVectorToPoint-C5fA5x6U.js";import"./MeshComponent-Vga6qE-G.js";import"./imageUtils-LnXySzmN.js";import"./meshVertexSpaceUtils-gkGG_eew.js";import"./MeshLocalVertexSpace-BNetD1iK.js";import"./georeference-TQxFGYYy.js";import"./interfaces-DkjgzG8v.js";import"./DefaultLayouts-C3Py-gzy.js";import"./Intersector-Cp54otHo.js";import"./RenderCoordsHelper-D0uwfR3O.js";import"./scaleUtils-BKVOuLFd.js";import"./DefaultUI-4DBz9mkp.js";import"./ReactiveMap-DcQhQdHv.js";import"./IViewEvents-Bci6PjlS.js";import"./interfaces-D6pIddIh.js";import"./heightModelInfoUtils-CYfboRg2.js";import"./mat2df64-CBKYtunK.js";import"./normalizeUtils-PvjooRb6.js";import"./normalizeUtilsCommon-ByXMGwNF.js";import"./capabilities-C84AMSCg.js";import"./themeUtils-C3zvZbsE.js";import"./accessibleHandler-yeijlTke.js";import"./Compass-BqUvL1gL.js";import"./utils-DsJqvptN.js";import"./GoTo-B08Csiw_.js";import"./NavigationToggle-DNdSP6VQ.js";import"./Zoom-BQUhauBk.js";import"./viewpointUtils-QCB8ouyq.js";import"./spatialReferenceSupport-7FaIbiiv.js";import"./ElevationSamplerData-CLGqTcb_.js";import"./terrainUtils-uYCMkPpW.js";import"./TileInfo-Cj0aaJ6S.js";import"./TileKey-DZd6gJy7.js";import"./Environment-CdSNjorT.js";import"./projectPointToWGS84ComparableLonLat-JSQbLxiZ.js";import"./Program-wFflZSL5.js";import"./ShadowCastVisualizeTechniqueConfiguration-Cw3UK_Yj.js";import"./ray-DAW-uzC6.js";import"./ZoomMomentumEstimator-gQBuScvi.js";import"./labelFormatUtils-H994QWFK.js";import"./FeatureTileDescriptor3D-DHCjGIg_.js";import"./ElevationQueryTileCache-BKuK8tEK.js";import"./LayerConstants-B33OP6sh.js";import"./ElevationRange-BrgM1moX.js";import"./geometryServiceUtils-DQSAcvNz.js";import"./LercDecoder-DU0V7Jru.js";import"./WorkerHandle-CzrOFJZz.js";import"./RenderableTile-DtAne7GO.js";import"./enums-BRzLM11V.js";import"./TileStrategy-l1611y-Q.js";import"./TileKey-Dt_FQSdw.js";import"./QueueProcessor-CvAp86Lk.js";import"./config-MDUrh2eL.js";import"./DefaultVertexAttributeLayouts-o8Fw2Bif.js";import"./DisplayObject-B2mbaom_.js";import"./rasterUtils-Cy3YcRxv.js";import"./StyleDefinition-pu9RBNlY.js";import"./resources-DHuiDxSF.js";import"./edgeProcessing-y5myZLSQ.js";import"./EdgeWorkerHandle-BwQg52ff.js";import"./workerHelper-DtT1uotp.js";import"./testSVGPremultipliedAlpha-BWu01myj.js";import"./RenderingContext-WP9tAZpV.js";import"./ProgramCache-pF_7Wga5.js";const y="esri-daylight",V=`${y}__container`,b="esri-slider",g={base:y,widgetIcon:ne.environmentSettings,datePickerCalendarToggle:"esri-date-picker__calendar-toggle",dayContainer:`${V} ${y}__day-container`,dateContainer:`${V} ${y}__date-container`,containerDisabled:`${V}--disabled`,slider:b,sliderShadowOff:`${b}--shadow-off`,sliderShadowOn:`${b}--shadow-on`,sliderAmPmOn:`${b}--ampm-on`,sliderDateOff:`${b}--date-off`,sliderDateOn:`${b}--date-on`,playPauseButton:`${y}__play-pause-button`,seasonPicker:`${y}__season-picker`,panelError:`${y}__panel--error`,sunLightingCheckbox:`${y}__sun-lighting-checkbox`,shadowsCheckbox:`${y}__shadows-checkbox`};var u;(function(e){e[e.NORTHERN=0]="NORTHERN",e[e.SOUTHERN=1]="SOUTHERN"})(u||(u={}));const ke={spring:{dayOfMonth:20,month:2},summer:{dayOfMonth:21,month:5},fall:{dayOfMonth:23,month:8},winter:{dayOfMonth:21,month:11}},I=["spring","summer","fall","winter"];function P(e,t,i){const n=B(t,i),{dayOfMonth:l,month:r}=ke[n],d=new Date(e.getTime());return d.setMonth(r,l),d}function Oe(e,t){return B(Ce(e),t)}function Ce(e){const t=e.getTime(),i=P(e,"spring",u.NORTHERN).getTime(),n=P(e,"summer",u.NORTHERN).getTime(),l=P(e,"fall",u.NORTHERN).getTime(),r=P(e,"winter",u.NORTHERN).getTime();return t>=i&&t<n?"spring":t>=n&&t<l?"summer":t>=l&&t<r?"fall":"winter"}function B(e,t){return t===u.NORTHERN?e:Me(e)}function Me(e){const t=I.indexOf(e);return I[(t+2)%4]}function Le(e,t){return oe(e,t,"minutes")}function Ee(e){return le(e,"minutes")}function $e(e,t,i){if(e==null||t==null||isNaN(e.getTime())&&isNaN(t.getTime()))return 3e5;const p=i.getTime(),E=e.getTime(),$=t.getTime(),U=E-72e5/2,N=E+72e5/2,x=$-72e5/3*2,H=$+72e5/3;let O=3e5;return p>=U&&p<=N?O=p-U<=12e5?18e5-(p-U)/12e5*16e5:N-p<=12e5/2?3e5-(N-p)/12e5*2*1e5:2e5:p>=x&&p<=H?O=p-x<=12e5/2?3e5-(p-x)/12e5*2*1e5:H-p<=12e5?18e5-(H-p)/12e5*16e5:2e5:(p<E||p>$)&&(O=18e5),O}let v=class extends be{constructor(){super(...arguments),this.utcOffset=null,this.timezonePickerOpen=!1}};s([o()],v.prototype,"utcOffset",void 0),s([o()],v.prototype,"timezonePickerOpen",void 0),v=s([k("esri.widgets.Daylight.support.SliderWithDropdownViewModel")],v);const te="esri.widgets.Daylight.DaylightViewModel";let a=class extends Q{constructor(e){super(e),this.view=null,this.datePickerViewModel=new ee,this.timeSliderViewModel=new v({min:0,max:1439,values:[0],labelFormatFunction:J,inputFormatFunction:J}),this.lightingUpdateInterval=200,this._oldLighting=null,this.playSpeedMultiplier=1,this._lastTime=null,this._sunrise=null,this._sunset=null,this._cachedLightingDateUTC=new Date(0),this._cachedDisplayUTCOffset=0,this._firstInteraction=!0,this._lastLightingUpdate=0,this._lightingUpdateHandle=null}initialize(){this.addHandles([X(()=>this.view,e=>e.when(()=>this._updateLighting()),F),m(()=>{const e=this._lighting;return(e==null?void 0:e.type)==="sun"?C(e):null},e=>this._scheduleLightingUpdate(e)),ae(()=>this._lighting,"timezone-will-change",e=>this._timezoneWillChange(e),{onListenerAdd:()=>this._timezoneWillChange(null)}),m(()=>{var e;return((e=this.view)==null?void 0:e.stationary)===!0},()=>{(this.dayPlaying||this.yearPlaying)&&this._updateSunriseAndSunset()},F),m(()=>{const e=this.timeSliderViewModel;return{vm:e,state:e.state,sliderPosition:this.timeSliderPosition}},({vm:e,state:t,sliderPosition:i})=>{t==="ready"&&e.setValue(0,i)}),m(()=>{var e;return(e=this.timeSliderViewModel)==null?void 0:e.utcOffset},e=>{e!=null&&(this.utcOffset=e)}),m(()=>({utcOffset:this.utcOffset,sliderViewModel:this.timeSliderViewModel}),({utcOffset:e,sliderViewModel:t})=>{t&&(t.utcOffset=e)},D),m(()=>this.timeSliderViewModel.timezonePickerOpen,()=>this.stopPlaying()),m(()=>this.timeSliderViewModel.values,e=>this._setTimeSliderPosition((e==null?void 0:e[0])??0,{forceLightingUpdate:!1})),m(()=>this.datePickerViewModel.value,e=>{this.dayPlaying=!1,this.localDate=e}),m(()=>this.localDate,e=>{this.datePickerViewModel.value.valueOf()!==e.getTime()&&this.datePickerViewModel.set("value",e)})])}destroy(){this._cancelLightingUpdate(),this.view=null}get isSupported(){return this.view==null||this.view.type==="3d"}get utcOffset(){return this._cachedDisplayUTCOffset}set utcOffset(e){e!==this.utcOffset&&this._lighting!=null&&this._lighting.type!=="virtual"&&(this._lighting.displayUTCOffset=e,this._updateLighting())}get localDate(){return re(this._lightingDateDisplay)}set localDate(e){L(e)&&e.getTime()!==this.localDate.getTime()&&(this._lightingDateDisplay=de(this._lightingDateDisplay,e))}get timeSliderPosition(){return Ee(this._lightingDateDisplay)}set timeSliderPosition(e){this._setTimeSliderPosition(e,{forceLightingUpdate:!0})}_setTimeSliderPosition(e,t){Math.abs(e-this.timeSliderPosition)<=1/60||(this.stopPlaying(),this._enableDirectShadowsIfFirstInteraction(),t.forceLightingUpdate&&(this._cancelLightingUpdate(),this._updateLighting()),this._lightingDateDisplay=Le(this._lightingDateDisplay,e))}_timezoneFromCamera(e,t){if(t==null||!e.cameraTrackingEnabled)return 0;const i=ve([t.longitude,t.latitude]);return i==null?0:Math.round(i.hours+i.minutes/60+i.seconds/3600)}get directShadowsEnabled(){var e;return((e=this._lighting)==null?void 0:e.directShadowsEnabled)??!1}set directShadowsEnabled(e){const t=this._lighting;t&&(t.directShadowsEnabled=e)}get sunLightingEnabled(){return this._lightingType==="sun"}set sunLightingEnabled(e){const t=this._environment;if(e===this._get("sunLightingEnabled")||t==null)return;const i=t.lighting,n=this._oldLighting;this._oldLighting=i;const l={directShadowsEnabled:i.directShadowsEnabled,cameraTrackingEnabled:i.cameraTrackingEnabled},r=e?"sun":"virtual";let d;d=n!=null&&n.type===r?n:e?new G:new fe,d.set(l),t.lighting=d,e||(this.stopPlaying(),this.timeSliderViewModel.timezonePickerOpen=!1)}set playingState(e){this.playingState!==e&&(this._set("playingState",e),e!=="none"&&this.sunLightingEnabled&&(this._updateSunriseAndSunset(),this._lastTime=Date.now(),this._play(),this._enableDirectShadowsIfFirstInteraction()))}get dayPlaying(){return this.playingState==="day"}set dayPlaying(e){e?this.playingState="day":this.dayPlaying&&(this.playingState="none")}get yearPlaying(){return this.playingState==="year"}set yearPlaying(e){e?this.playingState="year":this.yearPlaying&&(this.playingState="none")}get currentSeason(){return Oe(this.localDate,this._currentHemisphere)}set currentSeason(e){this.stopPlaying();const t=B(e,this._currentHemisphere);this.localDate=P(this.localDate,t,u.NORTHERN)}get _currentHemisphere(){var t,i,n;const e=(n=(i=(t=this.view)==null?void 0:t.camera)==null?void 0:i.position)==null?void 0:n.latitude;return e==null||e>=0?u.NORTHERN:u.SOUTHERN}get _environment(){var e;return(e=this.view)==null?void 0:e.environment}get _lighting(){var e;return(e=this._environment)==null?void 0:e.lighting}get _lightingType(){var e;return(e=this._lighting)==null?void 0:e.type}get _lightingDateDisplay(){return W(this._cachedLightingDateUTC,this._cachedDisplayUTCOffset,"hours")}set _lightingDateDisplay(e){const t=this._lighting;if(t==null||!this.sunLightingEnabled||t.type==="virtual"||!L(e))return;const i=C(t),n=W(e,-this._cachedDisplayUTCOffset,"hours");n.getTime()!==i.getTime()&&(t.date=n,this._updateLighting())}stopPlaying(){this.playingState="none"}toggleDayPlaying(){this.dayPlaying=!this.dayPlaying}toggleYearPlaying(){this.yearPlaying=!this.yearPlaying}toggleSunLightingEnabled(){this.stopPlaying(),this.sunLightingEnabled=!this.sunLightingEnabled}toggleDirectShadowsEnabled(){this.stopPlaying(),this.directShadowsEnabled=!this.directShadowsEnabled}_enableDirectShadowsIfFirstInteraction(){this._firstInteraction&&(this._firstInteraction=!1,this.directShadowsEnabled=!0)}_updateLighting(e){var d;const t=Date.now();this._lastLightingUpdate=t;const{view:i}=this,n=this._lighting;if(i==null||n==null||n.type==="virtual")return;e??(e=C(n));const l=n.displayUTCOffset,r=l!==null?l:this._timezoneFromCamera(n,(d=i.camera)==null?void 0:d.position);this._cachedLightingDateUTC.getTime()!==e.getTime()&&(this._cachedLightingDateUTC=new Date(e.getTime())),this._cachedDisplayUTCOffset!==r&&(this._cachedDisplayUTCOffset=r)}_timezoneWillChange(e){const t=this._lighting;if(t==null||t.type==="virtual"||!t.cameraTrackingEnabled)return;let i;if(e)i=e.timezoneOffset;else{if(t.displayUTCOffset!=null)return;i=G.calculateTimezoneOffset(t.positionTimezoneInfo)}t.displayUTCOffset=i,this._scheduleLightingUpdate()}_scheduleLightingUpdate(e){if(e&&(this._lightingUpdateHandle=q(this._lightingUpdateHandle),!L(e))||this._lightingUpdateHandle)return;const t=Date.now()-this._lastLightingUpdate,i=this.lightingUpdateInterval-t;let n=null;const l=()=>{this._updateLighting(e),this._lightingUpdateHandle===n&&(this._lightingUpdateHandle=null)};if(i<=0)this._lightingUpdateHandle=n=he(l);else{const r=setTimeout(l,i);this._lightingUpdateHandle=n=pe(()=>clearTimeout(r))}}_cancelLightingUpdate(){this._lightingUpdateHandle=q(this._lightingUpdateHandle)}_play(){const e=this._lighting;if(e==null||!this.sunLightingEnabled||e.type==="virtual")return;const t=C(e);if(this.dayPlaying||this.yearPlaying){const i=Date.now()-(this._lastTime??0);if(this.dayPlaying){this._lastTime=Date.now();const n=$e(this._sunrise,this._sunset,t)*this.playSpeedMultiplier/100*i;if(n>0){let l=new Date(t.getTime()+n);const r=e.displayUTCOffset??0;((l.getUTCHours()+r)%24+24)%24<((t.getUTCHours()+r)%24+24)%24&&(l=new Date(t.getTime()+n-864e5)),e.date=l}}else if(i>1e3){this._lastTime=Date.now();const n=(t.getUTCMonth()+1)%12,l=new Date(t.getTime());l.setUTCMonth(n),e.date=l}requestAnimationFrame(()=>this._play())}}_updateSunriseAndSunset(){var w,p;const e=this._lighting;if(e==null||e.type==="virtual"||!this.sunLightingEnabled)return;const t=(p=(w=this.view)==null?void 0:w.camera)==null?void 0:p.position;if(t==null)return;const{latitude:i,longitude:n}=t,{date:l,displayUTCOffset:r}=e,d=Te(l,i,n,r??0);d&&(this._sunrise=new Date(d.sunrise),this._sunset=new Date(d.sunset))}};function C(e){return L(e.date)||(Z.getLogger(te).warn("Invalid date. Reverting to the current date/time."),e.date=new Date),e.date}s([o({type:we})],a.prototype,"view",void 0),s([o({type:ee,nonNullable:!0})],a.prototype,"datePickerViewModel",void 0),s([o({type:v,nonNullable:!0})],a.prototype,"timeSliderViewModel",void 0),s([o()],a.prototype,"isSupported",null),s([o()],a.prototype,"lightingUpdateInterval",void 0),s([o()],a.prototype,"utcOffset",null),s([o()],a.prototype,"localDate",null),s([o()],a.prototype,"timeSliderPosition",null),s([o()],a.prototype,"directShadowsEnabled",null),s([o()],a.prototype,"sunLightingEnabled",null),s([o({type:["none","day","year"],value:"none"})],a.prototype,"playingState",null),s([o()],a.prototype,"dayPlaying",null),s([o()],a.prototype,"yearPlaying",null),s([o()],a.prototype,"playSpeedMultiplier",void 0),s([o()],a.prototype,"currentSeason",null),s([o()],a.prototype,"_lastTime",void 0),s([o()],a.prototype,"_sunrise",void 0),s([o()],a.prototype,"_sunset",void 0),s([o()],a.prototype,"_cachedLightingDateUTC",void 0),s([o()],a.prototype,"_cachedDisplayUTCOffset",void 0),s([o()],a.prototype,"_firstInteraction",void 0),s([o()],a.prototype,"_currentHemisphere",null),s([o()],a.prototype,"_environment",null),s([o()],a.prototype,"_lighting",null),s([o()],a.prototype,"_lightingType",null),s([o()],a.prototype,"_lightingDateDisplay",null),a=s([k(te)],a);const ie=a;let _=class extends Q{constructor(e){super(e),this.header=!0,this.playButtons=!0,this.datePicker=!0,this.timezone=!0,this.sunLightingToggle=!0,this.shadowsToggle=!0}};s([o({type:Boolean,nonNullable:!0})],_.prototype,"header",void 0),s([o({type:Boolean,nonNullable:!0})],_.prototype,"playButtons",void 0),s([o({type:Boolean,nonNullable:!0})],_.prototype,"datePicker",void 0),s([o({type:Boolean,nonNullable:!0})],_.prototype,"timezone",void 0),s([o({type:Boolean,nonNullable:!0})],_.prototype,"sunLightingToggle",void 0),s([o({type:Boolean,nonNullable:!0})],_.prototype,"shadowsToggle",void 0),_=s([k("esri.widgets.Daylight.VisibleElements")],_);const se=_,z="esri-slider-with-dropdown",M={label:"esri-slider__label",box:`${z}__box`,boxDropDownOn:`${z}__box--drop-down-on`,boxDropDownOff:`${z}__box--drop-down-off`};let S=class extends Se{constructor(e,t){super(e,t),this.viewModel=new v,this.showDropDown=!0,this._labelWidth=0,this._onLabelAfterCreate=i=>{const n="label-size-observer";this.removeHandles(n),this.addHandles(ge(i,({contentRect:l})=>{this._labelWidth=l.width}),n)},this._getLabelStyles=()=>{if(!this.trackElement)return;const i=this._trackWidth,n=this._labelWidth/2,l=this.getCurrentPosition(),r=l-n,d=l+n;let w=-n;return r<0?w+=-r:d>i&&(w+=i-d),{left:`${w}px`}},this._onTimezoneChange=i=>{this.viewModel.utcOffset=i},this._onTimezonePickerOpen=()=>{this.viewModel.timezonePickerOpen=!0},this._onTimezonePickerClose=()=>{this.viewModel.timezonePickerOpen=!1}}renderThumbLabel(e){const{showDropDown:t,viewModel:i}=this;return c("div",{afterCreate:this._onLabelAfterCreate,class:this.classes({[M.box]:!0,[M.label]:!0,[M.boxDropDownOn]:t,[M.boxDropDownOff]:!t}),key:"thumb-label",styles:this._getLabelStyles()},super.renderThumbLabel(e),t?c(De,{open:i.timezonePickerOpen,value:i.utcOffset,onChange:this._onTimezoneChange,onClose:this._onTimezonePickerClose,onOpen:this._onTimezonePickerOpen}):null)}};s([o()],S.prototype,"viewModel",void 0),s([o()],S.prototype,"showDropDown",void 0),s([o()],S.prototype,"_labelWidth",void 0),S=s([k("esri.widgets.Daylight.support.SliderWithDropdown")],S);const Ue=S,K=/(.*)\s(.*)/,A="date",j="esri.widgets.Daylight";let h=class extends ce{constructor(e,t){super(e,t),this.headingLevel=3,this.iconClass=g.widgetIcon,this.icon=null,this.viewModel=new ie,this.visibleElements=new se,this.dateOrSeason=A,this._timeSlider=new Ue({viewModel:this.viewModel.timeSliderViewModel,steps:this.timeSliderSteps,labelInputsEnabled:!1,visibleElements:{labels:!0},tickConfigs:[{mode:"position",values:[0,360,720,1080,1439],labelsVisible:!0,tickCreatedFunction:this._onPrimaryTickCreated.bind(this)},{mode:"position",values:[120,240,480,600,840,960,1200,1320],tickCreatedFunction:this._onSecondaryTickCreated.bind(this)}]}),this._datePicker=new Pe({viewModel:this.viewModel.datePickerViewModel,commitOnMonthChange:!0}),this._onPlayDayClick=()=>{this.viewModel.toggleDayPlaying()},this._onYearPlayClick=()=>{this.viewModel.toggleYearPlaying()},this._onSeasonChange=i=>{this.viewModel.currentSeason=i.target.value},this._onSunLightingCheckboxChange=()=>{this.viewModel.toggleSunLightingEnabled()},this._onShadowCheckboxChange=()=>{this.viewModel.toggleDirectShadowsEnabled()}}get label(){var e;return((e=this.messages)==null?void 0:e.title)??""}set label(e){this._overrideIfSome("label",e)}get playSpeedMultiplier(){return this.viewModel.playSpeedMultiplier}set playSpeedMultiplier(e){this.viewModel.playSpeedMultiplier=e}get timeSliderSteps(){var e;return((e=this._timeSlider)==null?void 0:e.steps)??5}set timeSliderSteps(e){this._timeSlider.steps=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get test(){return{datePicker:this._datePicker}}get _useAmPm(){const e=this._timeSlider.viewModel.getLabelForValue(0,"tick");return e!=null&&K.test(e)}postInitialize(){this.viewModel.isSupported&&this.addHandles([m(()=>this.viewModel.datePickerViewModel,e=>this._datePicker.viewModel=e,D),m(()=>this.viewModel.timeSliderViewModel,e=>this._timeSlider.viewModel=e,D),m(()=>{var e;return(e=this.visibleElements)==null?void 0:e.timezone},e=>this._timeSlider.showDropDown=e,D),m(()=>!this.viewModel.sunLightingEnabled,e=>{this._datePicker.disabled=e,this._timeSlider.disabled=e},D),X(()=>!this.visible,()=>{var e;return(e=this._datePicker)==null?void 0:e.close(!1)},me)])}destroy(){this._datePicker.destroy(),this._timeSlider.destroy()}render(){const{messages:e,viewModel:t,visibleElements:i}=this,n=t.isSupported;return c("div",{class:this.classes(g.base,f.widget)},n?c(ue,null,i.header?c(ye,{level:this.headingLevel},e.title):null,this._renderTimeOptions(),i.datePicker?this._renderDateOrSeason():null,i.sunLightingToggle?this._renderSunLightingToggle():null,i.shadowsToggle?this._renderShadowsToggle():null):c("div",{class:g.panelError,key:"unsupported"},c("p",null,e.unsupported)))}loadDependencies(){return _e({button:()=>T(()=>import("./calcite-button-CqG1PB6a.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])),checkbox:()=>T(()=>import("./calcite-checkbox-BsA-vHIv.js"),__vite__mapDeps([16,2,3,5,4,6,11,7,8,9])),label:()=>T(()=>import("./calcite-label-D93hjYEn.js"),__vite__mapDeps([17,2,3,7,5,8])),option:()=>T(()=>import("./calcite-option-DRecTMIe.js"),__vite__mapDeps([18,2,3,12])),select:()=>T(()=>import("./calcite-select-DIYH3iOC.js"),__vite__mapDeps([19,2,3,5,4,6,7,8,9,12,20,14,21]))})}_renderTimeOptions(){const{viewModel:e,visibleElements:t,messages:i}=this,{directShadowsEnabled:n,dayPlaying:l}=e,r=!e.sunLightingEnabled;return c("div",{class:this.classes(g.dayContainer,{[g.sliderShadowOn]:n,[g.sliderShadowOff]:!n,[g.sliderDateOn]:t.datePicker,[g.sliderDateOff]:!t.datePicker,[g.sliderAmPmOn]:this._useAmPm,[g.containerDisabled]:r}),key:"daylight-time-options"},this._timeSlider.render(),t.playButtons?this._renderPlayPauseButton({playing:l,disabled:r,label:i.playDay,onClick:this._onPlayDayClick}):null)}_renderDateOptions(){const{viewModel:e,visibleElements:t,messages:i}=this,{yearPlaying:n}=e,l=!e.sunLightingEnabled;return c("div",{class:this.classes(g.dateContainer,l&&g.containerDisabled),key:"daylight-date"},this._datePicker.render(),t.playButtons?this._renderPlayPauseButton({playing:n,disabled:l,label:i.playYear,onClick:this._onYearPlayClick}):null)}_renderPlayPauseButton({playing:e,disabled:t,label:i,onClick:n}){return c("calcite-button",{appearance:"solid",class:g.playPauseButton,disabled:t,iconStart:e?"pause-f":"play-f",label:i,onclick:n,round:!0,title:i,type:"button"})}_renderSeasonSelect(){const{messages:e,viewModel:t}=this,i=!t.sunLightingEnabled;return c("calcite-select",{class:this.classes(g.seasonPicker),disabled:i,label:e.season,onCalciteSelectChange:this._onSeasonChange},I.map(n=>c("calcite-option",{selected:t.currentSeason===n,value:n},e[n])))}_renderDateOrSeason(){return this.dateOrSeason==="date"?this._renderDateOptions():this._renderSeasonSelect()}_renderSunLightingToggle(){var t;const e=(t=this.messages)==null?void 0:t.sunLightingToggle;return c("calcite-label",{key:"date-time-toggle",layout:"inline",scale:"s",title:e==null?void 0:e.tooltip},c("calcite-checkbox",{checked:this.viewModel.sunLightingEnabled,class:g.sunLightingCheckbox,onCalciteCheckboxChange:this._onSunLightingCheckboxChange}),e==null?void 0:e.label)}_renderShadowsToggle(){const e=this.messages.shadowsToggle;return c("calcite-label",{key:"shadow-toggle",layout:"inline",scale:"s",title:e==null?void 0:e.tooltip},c("calcite-checkbox",{checked:this.viewModel.directShadowsEnabled,class:g.shadowsCheckbox,onCalciteCheckboxChange:this._onShadowCheckboxChange}),e.label)}_onPrimaryTickCreated(e,t,i){t.classList.add(...R,f.primaryTick),i.classList.add(...R,f.primaryTickLabel),i.onclick=t.onclick=this._makeGoToTime(e);const n=i.textContent,l=n!=null&&K.exec(n);l&&(i.innerHTML=`${l[1]}<br><div class=${f.primaryTickAmPm}>${l[2]}</div>`)}_onSecondaryTickCreated(e,t){t.classList.add(...R,f.secondaryTick),t.onclick=this._makeGoToTime(e)}_makeGoToTime(e){return()=>{this.viewModel.timeSliderPosition=e}}};s([o(),Y("esri/widgets/Daylight/t9n/Daylight")],h.prototype,"messages",void 0),s([o(),Y("esri/widgets/support/t9n/timezone")],h.prototype,"timezoneMessages",void 0),s([o()],h.prototype,"headingLevel",void 0),s([o()],h.prototype,"iconClass",void 0),s([o()],h.prototype,"icon",void 0),s([o()],h.prototype,"label",null),s([o()],h.prototype,"playSpeedMultiplier",null),s([o()],h.prototype,"timeSliderSteps",null),s([o()],h.prototype,"view",null),s([o({type:ie})],h.prototype,"viewModel",void 0),s([o({type:se,nonNullable:!0})],h.prototype,"visibleElements",void 0),s([o({cast:e=>e==="season"||e==="date"?e:(Z.getLogger(j).warn(`"${e}" is not a valid option. Acceptable values are only "date" or "season". Defaulting to "${A}".`),A)})],h.prototype,"dateOrSeason",void 0),s([o()],h.prototype,"_timeSlider",void 0),s([o()],h.prototype,"_useAmPm",null),s([o()],h.prototype,"_datePicker",void 0),h=s([k(j)],h);const R=[f.interactive,f.anchor],ws=h;export{ws as default};

import{bh as l,aI as u,eO as c,cR as y,aU as f,hn as g,x as w,B as V}from"./index-B252NKV0.js";import{m as v}from"./LayerView2D-B2XPas4a.js";import{u as C}from"./LayerView-D2pvr0Q6.js";import"./scaleUtils-BKVOuLFd.js";import"./Container-D0mzr_VC.js";import"./DefaultUI-4DBz9mkp.js";import"./ReactiveMap-DcQhQdHv.js";import"./IViewEvents-Bci6PjlS.js";import"./interfaces-D6pIddIh.js";import"./heightModelInfoUtils-CYfboRg2.js";import"./mat2df64-CBKYtunK.js";import"./mat3-DPPMYMhB.js";import"./vec2f32-BbH2jxlN.js";import"./normalizeUtils-PvjooRb6.js";import"./normalizeUtilsCommon-ByXMGwNF.js";import"./capabilities-C84AMSCg.js";import"./themeUtils-C3zvZbsE.js";import"./accessibleHandler-yeijlTke.js";import"./Compass-BqUvL1gL.js";import"./utils-DsJqvptN.js";import"./GoTo-B08Csiw_.js";import"./NavigationToggle-DNdSP6VQ.js";import"./Zoom-BQUhauBk.js";import"./EffectView-CzpqZJb_.js";import"./DisplayObject-B2mbaom_.js";import"./highlightReasons-DkCnfpXT.js";import"./Tile-DcDRio1X.js";import"./quickselect-CDrMhodd.js";import"./TileKey-Dt_FQSdw.js";import"./definitions-B54owTRu.js";import"./enums-DSseSvdG.js";import"./Texture-BT-WYJiR.js";import"./ClipRect-CGrUtOuF.js";const o=Symbol();let p=class extends v(C){constructor(){super(...arguments),this.layerViews=new l,this._debouncedUpdate=u(async()=>{const{layer:e,parent:{footprintLayerView:i}}=this;let s=[];if(i){const d=this._createQuery(),{features:n}=await i.queryFeatures(d);this.suspended||(s=n.map(r=>e.acquireLayer(r)))}this.removeHandles(o),this.addHandles(s,o)})}attach(){this.addAttachHandles([this._updatingHandles.addOnCollectionChange(()=>this.layerViews,()=>this._updateStageChildren(),{initial:!0}),c(()=>{var e;return((e=this.parent.footprintLayerView)==null?void 0:e.dataUpdating)===!1},()=>this._updateLayers()),y(()=>{var e;return[this.layer.maximumVisibleSublayers,this.suspended,(e=this.parent.footprintLayerView)==null?void 0:e.filter]},()=>this._updateLayers())])}detach(){this.container.removeAllChildren(),this.removeHandles(o)}update(e){}moveStart(){}viewChange(){}moveEnd(){}isUpdating(){return this.layerViews.some(e=>e.updating)}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((e,i)=>this.container.addChildAt(e.container,i))}_updateLayers(){this.suspended?this.removeHandles(o):this._updatingHandles.addPromise(this._debouncedUpdate().catch(e=>{f.getLogger(this).error(e)}))}_createQuery(){const{parent:{footprintLayerView:e},layer:{maximumVisibleSublayers:i,parent:{itemTypeField:s,itemSourceField:d,objectIdField:n,orderBy:r}}}=this,h=`${s} <> 'Scene Service'`,t=e.createQuery();t.returnGeometry=!1,t.num=i,t.outFields=[n,d],t.where=g(t.where,h);const a=r==null?void 0:r.find(m=>m.field&&!m.valueExpression);return a!=null&&a.field&&(t.orderByFields=[`${a.field} ${a.order==="descending"?"DESC":"ASC"}`]),t}};p=w([V("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")],p);const te=p;export{te as default};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ImageMaterial.glsl-DaiqvPTQ.js","assets/index-DPJiPkbh.js","assets/index-HngaTkmj.css","assets/quat-B_RTSvGc.js","assets/RenderObject-B0ii-u5E.js","assets/hydratedFeatures-DhDSkMoS.js","assets/ColorMaterial.glsl-yoRZJYnh.js","assets/mat3-CakTilsz.js","assets/BufferView-D7hl-e1J.js","assets/IntegerPassUniform-Cz4js9jy.js","assets/enums-DSseSvdG.js","assets/Texture-BRxaK8g9.js","assets/BindType-BmZEZMMh.js","assets/interfaces-CGza0uBR.js","assets/Util-C76gCxal.js","assets/VertexAttribute-BnAa5VW0.js","assets/basicInterfaces-DngWxyLO.js","assets/ShaderTechniqueConfiguration-Ba2Oo7i0.js","assets/doublePrecisionUtils-B0owpBza.js","assets/Material-CcaRhBp-.js","assets/ContentObject-tLjB2Ud3.js","assets/requestImageUtils-QtRT18sL.js","assets/InterleavedLayout-nriK6Yun.js","assets/types-D0PSWh4d.js","assets/VertexColor.glsl-COPd45YS.js","assets/OrderIndependentTransparency-Dar7ikM6.js","assets/ElevationContext-DtSabp_5.js","assets/axisAngleDegrees-B1MWDIoz.js","assets/weather-Ce7bakF4.js","assets/RenderState-DaVlEYWY.js","assets/NestedMap-DgiGbX8E.js","assets/frustum-0hRlYIm-.js","assets/Attribute-B-NAci_J.js","assets/Geometry-BiufU1jP.js","assets/Indices-ijvqWnhD.js","assets/triangle-aMXw_G3u.js","assets/lineSegment-BXFQuctu.js","assets/Octree-CGixHoMx.js","assets/floatRGBA-CHZINRxm.js","assets/Intersector-G-a_ey6X.js","assets/ElevationProvider-DuAnZ1w5.js","assets/boundedPlane-C7AEtm0i.js","assets/verticalOffsetUtils-5CRVG66a.js","assets/orientedBoundingBox-BABDZfWD.js","assets/spatialReferenceEllipsoidUtils-MJ9Uj9G-.js","assets/computeTranslationToOriginAndRotation-DJULrcwj.js","assets/glUtil-DS73TAjp.js","assets/VertexElementDescriptor-BOD-G50G.js","assets/VertexArrayObject-BGsrrzff.js","assets/BufferObject-wa67LmxE.js","assets/Scheduler-B7taRppB.js","assets/debugFlags-BTuu0IjQ.js","assets/vec3f32-Cw9Q6TO_.js","assets/DoubleArray-MGZZXTmk.js","assets/ray-cdkbAool.js","assets/interfaces-D6pIddIh.js","assets/SlicePlane-D-UzsKax.js","assets/persistable-DMdbJ5yQ.js","assets/multiOriginJSONSupportUtils-C0wm8_Yw.js","assets/resourceExtension-BlAvASkD.js","assets/LineVisualElement-CuehpRAX.js","assets/Object3DVisualElement-Dqi1mRTf.js","assets/VisualElement-By0aUKlt.js","assets/line-BSkXm7S3.js","assets/triangulationUtils-19KnAipc.js","assets/earcut-nZVQjWaZ.js","assets/deduplicate-BSZzOE1N.js","assets/DefaultLayouts-Drvj0JwT.js","assets/RenderCoordsHelper-DFKqBCUS.js","assets/projectVectorToPoint-iRqWB51r.js"])))=>i.map(i=>d[i]);
import{y as $}from"./BufferView-D7hl-e1J.js";import{o as I,d as A,P as O,a as S,s as b,b as x,c as l,e as E,f as D,g as C,h as w,r as N,i as R,j as V,k as L,l as F,A as f,m as g,n as M}from"./IntegerPassUniform-Cz4js9jy.js";import{e as v}from"./basicInterfaces-DngWxyLO.js";import{o as U,u as B,r as z,d as G,A as W}from"./VertexColor.glsl-COPd45YS.js";import{u as j}from"./Material-CcaRhBp-.js";import{o as u,s as H,S as k,A as q,h as Q,l as J,a as K,E as X,_ as Y,b as Z,c as tt}from"./OrderIndependentTransparency-Dar7ikM6.js";import{s as et}from"./Util-C76gCxal.js";import{e as p}from"./VertexAttribute-BnAa5VW0.js";import{c as st}from"./DefaultLayouts-Drvj0JwT.js";import{e as at}from"./ColorMaterial.glsl-yoRZJYnh.js";import{x as i,_ as rt}from"./index-DPJiPkbh.js";import{o as c}from"./interfaces-CGza0uBR.js";import{r as o}from"./ShaderTechniqueConfiguration-Ba2Oo7i0.js";import{R as y}from"./enums-DSseSvdG.js";function it(s){const t=new I,{vertex:e,fragment:a}=t;return A(e,s),t.include(U,s),t.attributes.add(p.POSITION,"vec3"),t.attributes.add(p.UV0,"vec2"),s.perspectiveInterpolation&&t.attributes.add(p.PERSPECTIVEDIVIDE,"float"),t.varyings.add("vpos","vec3"),s.multipassEnabled&&t.varyings.add("depth","float"),e.code.add(c`
    void main(void) {
      vpos = position;
      ${s.multipassEnabled?"depth = (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0;
      gl_Position = transformPosition(proj, view, vpos);

      ${s.perspectiveInterpolation?"gl_Position *= perspectiveDivide;":""}
    }
  `),t.include(O,s),t.include(S,s),a.uniforms.add(new b("tex",n=>n.texture),new x("opacity",n=>n.opacity)),t.varyings.add("vTexCoord","vec2"),s.output===l.Alpha?a.code.add(c`
    void main() {
      discardBySlice(vpos);
      ${s.multipassEnabled?"terrainDepthTest(depth);":""}

      float alpha = texture(tex, vTexCoord).a * opacity;
      if (alpha  < ${c.float(E)}) {
        discard;
      }

      fragColor = vec4(alpha);
    }
    `):(a.include(D),a.code.add(c`
    void main() {
      discardBySlice(vpos);
      ${s.multipassEnabled?"terrainDepthTest(depth);":""}
      fragColor = texture(tex, vTexCoord) * opacity;

      if (fragColor.a < ${c.float(E)}) {
        discard;
      }

      fragColor = highlightSlice(fragColor, vpos);
      ${s.transparencyPassType===u.Color?"fragColor = premultiplyAlpha(fragColor);":""}
    }
    `)),t}const ot=Object.freeze(Object.defineProperty({__proto__:null,build:it},Symbol.toStringTag,{value:"Module"}));class _ extends N{initializeProgram(t){return new R(t.rctx,_.shader.get().build(this.configuration),T)}_setPipelineState(t,e){const a=this.configuration,n=t===u.NONE,d=t===u.FrontFace;return k({blending:a.output!==l.Color&&a.output!==l.Alpha||!a.transparent?null:n?nt:q(t),culling:Q(a.cullFace),depthTest:{func:J(t)},depthWrite:n?a.writeDepth?K:null:X(t),colorWrite:Y,stencilWrite:a.hasOccludees?V:null,stencilTest:a.hasOccludees?e?L:F:null,polygonOffset:n||d?null:Z(a.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipeline(t){return t?this._occludeePipelineState:super.getPipeline()}}_.shader=new w(ot,()=>rt(()=>import("./ImageMaterial.glsl-DaiqvPTQ.js").then(s=>s.D),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69])));const nt=H(y.ONE,y.ONE_MINUS_SRC_ALPHA);class r extends C{constructor(){super(...arguments),this.output=l.Color,this.cullFace=v.None,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=u.NONE,this.multipassEnabled=!1,this.cullAboveGround=!1,this.perspectiveInterpolation=!0}}i([o({count:l.COUNT})],r.prototype,"output",void 0),i([o({count:v.COUNT})],r.prototype,"cullFace",void 0),i([o()],r.prototype,"hasSlicePlane",void 0),i([o()],r.prototype,"transparent",void 0),i([o()],r.prototype,"enableOffset",void 0),i([o()],r.prototype,"writeDepth",void 0),i([o()],r.prototype,"hasOccludees",void 0),i([o({count:u.COUNT})],r.prototype,"transparencyPassType",void 0),i([o()],r.prototype,"multipassEnabled",void 0),i([o()],r.prototype,"cullAboveGround",void 0),i([o()],r.prototype,"perspectiveInterpolation",void 0),i([o({constValue:!1})],r.prototype,"occlusionPass",void 0);const T=new Map([[p.POSITION,0],[p.UV0,2],[p.PERSPECTIVEDIVIDE,3]]);class At extends at{constructor(t){super(t,new ct),this.supportsEdges=!0,this.produces=new Map([[f.OPAQUE_MATERIAL,e=>e===l.Highlight||g(e)&&!this.parameters.transparent],[f.TRANSPARENT_MATERIAL,e=>g(e)&&this.parameters.transparent&&this.parameters.writeDepth],[f.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,e=>g(e)&&this.parameters.transparent&&!this.parameters.writeDepth],[f.DRAPED_MATERIAL,e=>M(e)]]),this._vertexAttributeLocations=T,this._configuration=new r}getConfiguration(t,e){return this._configuration.output=t,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=e.transparencyPassType,this._configuration.enableOffset=e.camera.relativeElevation<tt,this._configuration.multipassEnabled=e.multipassEnabled,this._configuration.cullAboveGround=e.multipassTerrain.cullAboveGround,this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation,this._configuration}createGLMaterial(t){return new pt(t)}createBufferWriter(){const t=st.clone();return this.parameters.perspectiveInterpolation&&t.f32(p.PERSPECTIVEDIVIDE),new lt(t)}}class pt extends B{constructor(t){super({...t,...t.material.parameters})}_updateParameters(t){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(_,t)}_updateOccludeeState(t){t.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:t.hasOccludees}),this._updateParameters(t))}beginSlot(t){return this._output!==l.Color&&this._output!==l.Alpha||this._updateOccludeeState(t),this._updateParameters(t)}}class lt extends z{write(t,e,a,n,d){for(const h of this.vertexBufferLayout.fields.keys()){const m=a.attributes.get(h);if(m)if(h===p.PERSPECTIVEDIVIDE){et(m.size===1);const P=n.getField(h,$);P&&G(m,P,d)}else W(h,m,t,e,n,d)}}}class ct extends j{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=v.None,this.hasOccludees=!1,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0,this.perspectiveInterpolation=!1}}export{At as T,it as v};
